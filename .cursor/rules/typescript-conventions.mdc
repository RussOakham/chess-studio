---
description: "TypeScript conventions: type imports, strict mode, and type safety patterns"
globs: ["**/*.ts", "**/*.tsx"]
alwaysApply: false
---

# TypeScript Conventions

Follow these TypeScript conventions for consistency and type safety.

## Type Imports

**Always use type imports for types, interfaces, and type-only exports:**

```typescript
// ✅ Correct
import type { Doc, Id } from "convex/_generated/dataModel";
import type { Context } from "./context";
import { useQuery } from "convex/react"; // Value imports

// ❌ Incorrect
import { Doc, Id, useQuery } from "convex/react"; // Mixing type and value without type import
```

**Exception**: When importing both types and values from the same module, you can use regular imports, but prefer type imports when possible.

## Game and Move Types (Convex)

Game and move data live in Convex. Use Convex-generated types instead of inferring from a separate schema or repository:

- **Document types**: `Doc<"games">`, `Doc<"moves">` from `convex/_generated/dataModel`
- **ID types**: `Id<"games">`, `Id<"moves">` from `convex/_generated/dataModel`
- **API types**: Use the generated `api` from `convex/_generated/api`; function args and return types flow from Convex validators

See `@apps/web/convex/schema.ts`, `@apps/web/convex/games.ts`, and `@.cursor/rules/architecture-patterns.mdc`.

## UUID v7 (Non-Convex IDs)

Where UUIDs are used outside Convex (e.g. external APIs, legacy schema):

- Use UUID v7 (time-ordered) where appropriate
- Type definitions: `string` for UUID values
- **Note**: Convex table IDs use Convex's `Id<"tableName">` type, not UUID v7.

## Strict Mode

TypeScript strict mode is enabled. Follow these rules:

- **No `any` types** - Use `unknown` or proper types instead
- **Explicit return types** - Prefer explicit return types for functions
- **No unused variables** - Prefix with `_` if intentionally unused: `_unusedParam`
- **Handle promises** - Use `await` or `.then()`, never ignore promises

## Error Handling

Use proper error types:

```typescript
// ✅ Correct
if (error instanceof Error) {
  // Handle error
}
```

Throw clear errors with messages; in Convex handlers, throw for exceptional cases and return `null` for expected “not found” cases (see `@.cursor/rules/convex.mdc`).

## Path Aliases

Use path aliases consistently:

- `@/` - `apps/web/` (web app root)
- `@repo/chess` - `packages/chess`
- `@repo/types` - `packages/types`

## References

- Convex schema and types: `@apps/web/convex/schema.ts`, `@apps/web/convex/_generated/dataModel.d.ts`
- Architecture: `@.cursor/rules/architecture-patterns.mdc`
- Convex rules: `@.cursor/rules/convex.mdc`
